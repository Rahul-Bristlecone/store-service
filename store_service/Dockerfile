# 1Ô∏è‚É£ Base image: slim Python for smaller image size
FROM python:3.11-slim

# 2Ô∏è‚É£ Working directory inside the container
WORKDIR /app

# 3Ô∏è‚É£ Install system dependencies needed for mysqlclient
#RUN apk add --no-cache \
#    gcc \
#    musl-dev \
#    python3-dev \
#    mariadb-dev \
#    pkgconfig \
#    py3-pip

# 4Ô∏è‚É£ Copy requirements first to leverage Docker layer caching
COPY requirements.txt ./requirements.txt

# 5Ô∏è‚É£ Install Python dependencies
RUN pip install --no-cache-dir -r requirements.txt

# 6Ô∏è‚É£ Copy application code
COPY . ./store_service
#COPY . .

ENV PYTHONPATH=/app

# 7Ô∏è‚É£ Expose port Flask will run on
EXPOSE 5000

# 8Ô∏è‚É£ Start the Flask app
CMD ["python", "store_service/run.py"]

# üö´ Commented out ENTRYPOINT to avoid overriding CMD
# ENTRYPOINT ["top", "-b"]